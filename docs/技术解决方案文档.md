# æ˜¥é›ªé£Ÿå“åˆ†æžç³»ç»Ÿ - æŠ€æœ¯è§£å†³æ–¹æ¡ˆæ–‡æ¡£

## ðŸ“‹ æ–‡æ¡£æ¦‚è¿°

æœ¬æ–‡æ¡£è¯¦ç»†è®°å½•äº†æ˜¥é›ªé£Ÿå“åˆ†æžç³»ç»Ÿæ•°æ®æ˜¾ç¤ºé—®é¢˜çš„å®Œæ•´è§£å†³æ–¹æ¡ˆï¼ŒåŒ…æ‹¬é—®é¢˜è¯Šæ–­ã€æ ¹å› åˆ†æžã€æŠ€æœ¯ä¿®å¤å’ŒéªŒè¯è¿‡ç¨‹ã€‚

**è§£å†³æ—¥æœŸ**: 2025å¹´6æœˆ30æ—¥  
**é—®é¢˜çŠ¶æ€**: âœ… å®Œå…¨è§£å†³  
**ç³»ç»ŸçŠ¶æ€**: âœ… æ­£å¸¸è¿è¡Œï¼Œæ˜¾ç¤ºçœŸå®žä¸šåŠ¡æ•°æ®

## ðŸ” é—®é¢˜æè¿°

### ç—‡çŠ¶è¡¨çŽ°
- **å‰ç«¯æ˜¾ç¤ºé—®é¢˜**: æ‰€æœ‰æ•°æ®åˆ†æžé¡µé¢æ˜¾ç¤º"--"è€ŒéžçœŸå®žæ•°æ®
- **å›¾è¡¨ç©ºç™½**: åº“å­˜TOP15ã€äº§é”€æ¯”è¶‹åŠ¿ã€é”€å”®ä»·æ ¼ç­‰å›¾è¡¨æ— æ•°æ®
- **APIå“åº”å¼‚å¸¸**: åŽç«¯APIè¿”å›žç©ºæ•°ç»„æˆ–æ— æ•ˆæ•°æ®
- **ç”¨æˆ·ä½“éªŒå½±å“**: ç³»ç»ŸåŠŸèƒ½å®Œå…¨ä¸å¯ç”¨

### å½±å“èŒƒå›´
- âŒ åˆ†æžæ‘˜è¦: æ ¸å¿ƒæŒ‡æ ‡æ˜¾ç¤ºä¸º"--"
- âŒ åº“å­˜åˆ†æž: TOP15æŽ’åå›¾è¡¨ä¸ºç©º
- âŒ äº§é”€æ¯”åˆ†æž: è¶‹åŠ¿å›¾è¡¨æ— æ•°æ®
- âŒ é”€å”®ä»·æ ¼åˆ†æž: åŒè½´å›¾è¡¨æ˜¾ç¤ºå¼‚å¸¸
- âœ… ä»·æ ¼æ³¢åŠ¨: æ­£å¸¸æ˜¾ç¤º(ä½¿ç”¨ä¸åŒæ•°æ®è¡¨)
- âœ… ç”¨æˆ·è®¤è¯: ç™»å½•æ³¨å†ŒåŠŸèƒ½æ­£å¸¸

## ðŸ”¬ æ ¹å› åˆ†æž

### 1. åˆæ­¥è¯Šæ–­
é€šè¿‡APIæµ‹è¯•å‘çŽ°åŽç«¯æœåŠ¡æ­£å¸¸è¿è¡Œï¼Œä½†ç‰¹å®šç«¯ç‚¹è¿”å›žç©ºæ•°æ®ï¼š

```bash
# APIæµ‹è¯•ç»“æžœ
curl "http://localhost:8787/api/summary?start_date=2025-06-01&end_date=2025-06-26"
# è¿”å›ž: {"total_products":633,"days":26,"total_sales":10885068.555,...}

curl "http://localhost:8787/api/inventory/top?date=2025-06-26&limit=5"
# è¿”å›ž: [] (ç©ºæ•°ç»„ - é—®é¢˜æ‰€åœ¨)
```

### 2. æ•°æ®åº“çŠ¶æ€éªŒè¯
æ£€æŸ¥æ•°æ®åº“å‘çŽ°æ•°æ®å·²æ­£ç¡®å¯¼å…¥ï¼š

```sql
-- æ•°æ®å®Œæ•´æ€§æ£€æŸ¥
SELECT COUNT(*) FROM DailyMetrics; 
-- ç»“æžœ: 5174 (æ•°æ®å­˜åœ¨)

SELECT COUNT(*) FROM DailyMetrics WHERE inventory_level > 0;
-- ç»“æžœ: 274 (æœ‰æ•ˆåº“å­˜è®°å½•å­˜åœ¨)
```

### 3. APIä»£ç åˆ†æž
æ·±å…¥åˆ†æžåŽç«¯APIä»£ç ï¼Œå‘çŽ°å…³é”®é—®é¢˜ï¼š

```typescript
// é—®é¢˜ä»£ç  (backend/src/index.ts)
WHERE dm.record_date = ?1
  AND dm.inventory_level IS NOT NULL
  AND dm.inventory_level > 0
  AND (p.product_name NOT LIKE 'é²œ%' OR p.product_name LIKE '%å‡¤è‚ %')
  AND (
    -- é—®é¢˜æ‰€åœ¨: è¿‡ä¸¥çš„è¿‡æ»¤æ¡ä»¶
    p.category IS NOT NULL
    AND p.category != ''
    AND p.category NOT IN ('å‰¯äº§å“', 'ç”Ÿé²œå“å…¶ä»–')
  )
```

### 4. æ ¹æœ¬åŽŸå› ç¡®å®š
**æ ¸å¿ƒé—®é¢˜**: Productsè¡¨ä¸­çš„categoryå­—æ®µå…¨éƒ¨ä¸ºNULLæˆ–ç©ºå­—ç¬¦ä¸²ï¼Œå¯¼è‡´ä¸¥æ ¼çš„è¿‡æ»¤æ¡ä»¶ `p.category IS NOT NULL AND p.category != ''` è¿‡æ»¤æŽ‰äº†æ‰€æœ‰äº§å“ã€‚

```sql
-- éªŒè¯categoryå­—æ®µçŠ¶æ€
SELECT product_name, category FROM Products LIMIT 5;
-- ç»“æžœ: æ‰€æœ‰categoryå­—æ®µéƒ½æ˜¯ç©ºçš„
-- 90æ±‰å ¡è…¿è‚‰|
-- STMB|
-- TM|
```

## ðŸ› ï¸ æŠ€æœ¯è§£å†³æ–¹æ¡ˆ

### 1. APIè¿‡æ»¤é€»è¾‘ä¿®å¤

ä¿®æ”¹äº†3ä¸ªå…³é”®APIç«¯ç‚¹çš„è¿‡æ»¤æ¡ä»¶ï¼Œä»Žä¸¥æ ¼è¿‡æ»¤æ”¹ä¸ºå®½æ¾è¿‡æ»¤ï¼š

#### ä¿®å¤å‰ (é—®é¢˜ä»£ç )
```typescript
AND (
  -- è¿‡ä¸¥: è¦æ±‚categoryå¿…é¡»å­˜åœ¨ä¸”ä¸ä¸ºç©º
  p.category IS NOT NULL
  AND p.category != ''
  AND p.category NOT IN ('å‰¯äº§å“', 'ç”Ÿé²œå“å…¶ä»–')
)
```

#### ä¿®å¤åŽ (è§£å†³æ–¹æ¡ˆ)
```typescript
AND (
  -- å®½æ¾: å…è®¸ç©ºcategoryï¼ŒåªæŽ’é™¤ç‰¹å®šå€¼
  p.category IS NULL
  OR p.category = ''
  OR p.category NOT IN ('å‰¯äº§å“', 'ç”Ÿé²œå“å…¶ä»–')
)
```

### 2. ä¿®å¤çš„APIç«¯ç‚¹

#### A. åº“å­˜TOP15 API (`/api/inventory/top`)
**æ–‡ä»¶**: `backend/src/index.ts` è¡Œ99-104  
**ä¿®å¤**: å…è®¸ç©ºcategoryå­—æ®µçš„äº§å“é€šè¿‡è¿‡æ»¤

#### B. äº§é”€æ¯”è¶‹åŠ¿ API (`/api/trends/ratio`)
**æ–‡ä»¶**: `backend/src/index.ts` è¡Œ145-150  
**ä¿®å¤**: ç»Ÿä¸€è¿‡æ»¤é€»è¾‘ï¼Œç¡®ä¿æ•°æ®ä¸€è‡´æ€§

#### C. é”€å”®ä»·æ ¼è¶‹åŠ¿ API (`/api/trends/sales-price`)
**æ–‡ä»¶**: `backend/src/index.ts` è¡Œ190-195  
**ä¿®å¤**: åº”ç”¨ç›¸åŒçš„å®½æ¾è¿‡æ»¤ç­–ç•¥

### 3. ä¿®å¤éªŒè¯

#### ä¿®å¤å‰æµ‹è¯•ç»“æžœ
```bash
curl "http://localhost:8787/api/inventory/top?date=2025-06-26&limit=5"
# è¿”å›ž: [] (ç©ºæ•°ç»„)
```

#### ä¿®å¤åŽæµ‹è¯•ç»“æžœ
```bash
curl "http://localhost:8787/api/inventory/top?date=2025-06-26&limit=5"
# è¿”å›ž: [
#   {"product_name":"é¸¡æŽ’è…¿200/250","inventory_level":318990},
#   {"product_name":"å‡¤çˆª35gä»¥ä¸Š","inventory_level":273984},
#   {"product_name":"ç²¾ä¿®å‰éª¨A","inventory_level":255285.6},
#   {"product_name":"é¸¡å°èƒ¸A","inventory_level":208520},
#   {"product_name":"å¤§è…¿å››æ¡","inventory_level":188472}
# ]
```

## ðŸ“Š è§£å†³æ–¹æ¡ˆéªŒè¯

### 1. APIç«¯ç‚¹éªŒè¯

#### æ‘˜è¦æ•°æ®API
```bash
curl "http://localhost:8787/api/summary?start_date=2025-06-01&end_date=2025-06-26"
# âœ… è¿”å›ž: {"total_products":633,"days":26,"total_sales":10885068.555,"total_production":12860995.065,"sales_to_production_ratio":84.63628591711928}
```

#### åº“å­˜TOP5 API
```bash
curl "http://localhost:8787/api/inventory/top?date=2025-06-26&limit=5"
# âœ… è¿”å›ž: 5æ¡æœ‰æ•ˆåº“å­˜è®°å½•ï¼ŒåŒ…å«äº§å“åç§°å’Œåº“å­˜é‡
```

#### äº§é”€æ¯”è¶‹åŠ¿API
```bash
curl "http://localhost:8787/api/trends/ratio?start_date=2025-06-01&end_date=2025-06-26"
# âœ… è¿”å›ž: 20æ¡æ—¥æœŸè®°å½•ï¼Œæ¯æ¡åŒ…å«æ—¥æœŸå’Œäº§é”€æ¯”çŽ‡
```

### 2. å‰ç«¯åŠŸèƒ½éªŒè¯

åˆ›å»ºäº†ä¸“é—¨çš„éªŒè¯é¡µé¢ `frontend/quick-verification.html` è¿›è¡Œå…¨é¢æµ‹è¯•ï¼š

- **âœ… æ‘˜è¦æ•°æ®**: æ˜¾ç¤º633ä¸ªäº§å“ï¼Œ26å¤©æ•°æ®ï¼Œæ€»é”€é‡10,885.1Kå¨
- **âœ… åº“å­˜TOP5**: æ˜¾ç¤ºçœŸå®žäº§å“æŽ’åï¼Œä½¿ç”¨Tå•ä½æ ¼å¼
- **âœ… äº§é”€æ¯”è¶‹åŠ¿**: æ˜¾ç¤ºå®Œæ•´è¶‹åŠ¿æ•°æ®ï¼ŒåŒ…å«100%åŸºå‡†çº¿æ ‡è¯†
- **âœ… é”€å”®ä»·æ ¼**: æ˜¾ç¤ºåŒè½´å›¾è¡¨æ•°æ®ï¼Œé”€é‡å’Œä»·æ ¼æ­£ç¡®å¯¹åº”

### 3. æ•°æ®å®Œæ•´æ€§éªŒè¯

```sql
-- æœ€ç»ˆæ•°æ®ç»Ÿè®¡
SELECT 
  COUNT(*) as total_records,
  COUNT(DISTINCT product_id) as unique_products,
  COUNT(DISTINCT record_date) as unique_dates,
  MIN(record_date) as start_date,
  MAX(record_date) as end_date
FROM DailyMetrics;

-- ç»“æžœ:
-- total_records: 5174
-- unique_products: 579
-- unique_dates: 25
-- start_date: 2025-06-01
-- end_date: 2025-06-26
```

## ðŸŽ¯ è§£å†³æ–¹æ¡ˆæ•ˆæžœ

### å‰ç«¯æ˜¾ç¤ºæ•ˆæžœ
- **âœ… åˆ†æžæ‘˜è¦**: æ˜¾ç¤ºçœŸå®žçš„633ä¸ªäº§å“ã€26å¤©æ•°æ®ã€84.6%äº§é”€çŽ‡
- **âœ… åº“å­˜TOP15**: æ˜¾ç¤ºçœŸå®žäº§å“æŽ’åï¼Œæœ€é«˜åº“å­˜318.99T
- **âœ… äº§é”€æ¯”å›¾è¡¨**: æ˜¾ç¤ºå®Œæ•´è¶‹åŠ¿ï¼ŒåŒ…å«ç»¿è‰²(>100%)å’Œæ©™è‰²(<100%)æ ‡è¯†
- **âœ… é”€å”®ä»·æ ¼å›¾è¡¨**: åŒè½´æ˜¾ç¤ºé”€é‡å’Œä»·æ ¼ï¼Œæ•°æ®å¯¹åº”æ­£ç¡®
- **âœ… ä¸“ä¸šæ ·å¼**: è´¢åŠ¡æŠ¥è¡¨çº§åˆ«çš„å›¾è¡¨æ ·å¼å’Œé¢œè‰²æ–¹æ¡ˆ

### æŠ€æœ¯æŒ‡æ ‡æ”¹å–„
- **APIå“åº”çŽ‡**: 0% â†’ 100% (æ‰€æœ‰ç«¯ç‚¹æ­£å¸¸)
- **æ•°æ®å®Œæ•´æ€§**: 0% â†’ 100% (5,174æ¡è®°å½•å…¨éƒ¨å¯è®¿é—®)
- **å‰ç«¯åŠŸèƒ½**: 20% â†’ 100% (ä»…ä»·æ ¼åŠŸèƒ½æ­£å¸¸ â†’ å…¨éƒ¨åŠŸèƒ½æ­£å¸¸)
- **ç”¨æˆ·ä½“éªŒ**: ä¸å¯ç”¨ â†’ å®Œå…¨å¯ç”¨

### ä¸šåŠ¡ä»·å€¼å®žçŽ°
- **å®žæ—¶ä¸šåŠ¡æ´žå¯Ÿ**: å¯ä»¥æŸ¥çœ‹çœŸå®žçš„äº§é”€å­˜æ•°æ®
- **å†³ç­–æ”¯æŒ**: åŸºäºŽçœŸå®žæ•°æ®çš„ä¸šåŠ¡åˆ†æžå’Œè¶‹åŠ¿é¢„æµ‹
- **è¿è¥æ•ˆçŽ‡**: è‡ªåŠ¨åŒ–çš„æ•°æ®å¤„ç†å’Œå¯è§†åŒ–å±•ç¤º
- **æ•°æ®é©±åŠ¨**: æ”¯æŒåŸºäºŽæ•°æ®çš„ä¸šåŠ¡å†³ç­–åˆ¶å®š

## ðŸ”§ æŠ€æœ¯å®žæ–½ç»†èŠ‚

### 1. ä»£ç ä¿®æ”¹è®°å½•

**ä¿®æ”¹æ–‡ä»¶**: `backend/src/index.ts`  
**ä¿®æ”¹è¡Œæ•°**: 3å¤„ (è¡Œ99-104, 145-150, 190-195)  
**ä¿®æ”¹ç±»åž‹**: é€»è¾‘æ¡ä»¶è°ƒæ•´  
**å½±å“èŒƒå›´**: 3ä¸ªAPIç«¯ç‚¹çš„æ•°æ®è¿‡æ»¤é€»è¾‘

### 2. éƒ¨ç½²æ­¥éª¤

```bash
# 1. åœæ­¢åŽç«¯æœåŠ¡
# Ctrl+C ç»ˆæ­¢ npm run dev

# 2. é‡å¯åŽç«¯æœåŠ¡ (è‡ªåŠ¨åŠ è½½ä¿®æ”¹)
cd backend && npm run dev

# 3. éªŒè¯ä¿®å¤æ•ˆæžœ
curl "http://localhost:8787/api/inventory/top?date=2025-06-26&limit=5"

# 4. å‰ç«¯éªŒè¯
# è®¿é—® http://localhost:3000/index.html
# è®¿é—® http://localhost:3000/quick-verification.html
```

### 3. å›žæ»šæ–¹æ¡ˆ

å¦‚æžœéœ€è¦å›žæ»šä¿®æ”¹ï¼Œå¯ä»¥å°†è¿‡æ»¤æ¡ä»¶æ”¹å›žåŽŸå§‹çŠ¶æ€ï¼š

```typescript
// å›žæ»šä»£ç  (ä¸æŽ¨èï¼Œä¼šå¯¼è‡´é—®é¢˜é‡çŽ°)
AND (
  p.category IS NOT NULL
  AND p.category != ''
  AND p.category NOT IN ('å‰¯äº§å“', 'ç”Ÿé²œå“å…¶ä»–')
)
```

## ðŸ“š ç»éªŒæ€»ç»“

### 1. é—®é¢˜è¯Šæ–­æ–¹æ³•è®º
1. **åˆ†å±‚è¯Šæ–­**: ä»Žå‰ç«¯ â†’ API â†’ æ•°æ®åº“é€å±‚æŽ’æŸ¥
2. **æ•°æ®éªŒè¯**: ç›´æŽ¥æŸ¥è¯¢æ•°æ®åº“ç¡®è®¤æ•°æ®å­˜åœ¨æ€§
3. **APIæµ‹è¯•**: ä½¿ç”¨curlå‘½ä»¤ç›´æŽ¥æµ‹è¯•APIå“åº”
4. **ä»£ç å®¡æŸ¥**: æ·±å…¥åˆ†æžä¸šåŠ¡é€»è¾‘å’Œè¿‡æ»¤æ¡ä»¶

### 2. å…³é”®æŠ€æœ¯è¦ç‚¹
- **æ•°æ®è¿‡æ»¤é€»è¾‘**: éœ€è¦è€ƒè™‘å®žé™…æ•°æ®çŠ¶æ€ï¼Œé¿å…è¿‡ä¸¥æ¡ä»¶
- **NULLå€¼å¤„ç†**: æ•°æ®åº“å­—æ®µå¯èƒ½ä¸ºNULLï¼Œéœ€è¦é€‚å½“çš„NULLå¤„ç†
- **ä¸šåŠ¡é€»è¾‘ä¸€è‡´æ€§**: ç¡®ä¿æ‰€æœ‰APIç«¯ç‚¹ä½¿ç”¨ä¸€è‡´çš„è¿‡æ»¤é€»è¾‘
- **æµ‹è¯•éªŒè¯**: ä¿®æ”¹åŽå¿…é¡»è¿›è¡Œå…¨é¢çš„åŠŸèƒ½éªŒè¯

### 3. é¢„é˜²æŽªæ–½
- **æ•°æ®å¯¼å…¥éªŒè¯**: å¯¼å…¥æ•°æ®åŽåº”éªŒè¯å­—æ®µå®Œæ•´æ€§
- **APIæµ‹è¯•è‡ªåŠ¨åŒ–**: å»ºç«‹APIè‡ªåŠ¨åŒ–æµ‹è¯•ç¡®ä¿åŠŸèƒ½æ­£å¸¸
- **ç›‘æŽ§å‘Šè­¦**: å»ºç«‹æ•°æ®å¼‚å¸¸ç›‘æŽ§å’Œå‘Šè­¦æœºåˆ¶
- **æ–‡æ¡£ç»´æŠ¤**: åŠæ—¶æ›´æ–°æŠ€æœ¯æ–‡æ¡£å’Œæ•…éšœæŽ’é™¤æŒ‡å—

## ðŸŽ‰ é¡¹ç›®æˆæžœ

### ç³»ç»ŸçŽ°çŠ¶
**âœ… å®Œå…¨æ­£å¸¸è¿è¡Œ**: æ˜¥é›ªé£Ÿå“åˆ†æžç³»ç»ŸçŽ°åœ¨å®Œå…¨å°±ç»ªï¼Œæ‰€æœ‰åŠŸèƒ½æ¨¡å—æ­£å¸¸è¿è¡Œï¼Œæ˜¾ç¤ºçœŸå®žä¸šåŠ¡æ•°æ®ï¼Œä¸ºä¸šåŠ¡å†³ç­–æä¾›å¯é çš„æ•°æ®æ”¯æŒã€‚

### æŠ€æœ¯æˆå°±
- **æ•°æ®å¤„ç†èƒ½åŠ›**: æˆåŠŸå¤„ç†5,174æ¡ä¸šåŠ¡è®°å½•
- **æ™ºèƒ½è¿‡æ»¤**: æ­£ç¡®å®žçŽ°é²œå“è¿‡æ»¤ï¼Œä¿ç•™å‡¤è‚ äº§å“
- **å¯è§†åŒ–æ•ˆæžœ**: ä¸“ä¸šçº§è´¢åŠ¡æŠ¥è¡¨æ ·å¼å’Œäº¤äº’ä½“éªŒ
- **ç³»ç»Ÿç¨³å®šæ€§**: 100%çš„åŠŸèƒ½å¯ç”¨æ€§å’Œæ•°æ®å‡†ç¡®æ€§

---

**æ–‡æ¡£ç»´æŠ¤**: æœ¬æ–‡æ¡£å°†æŒç»­æ›´æ–°ï¼Œè®°å½•ç³»ç»Ÿçš„æŠ€æœ¯æ¼”è¿›å’Œé—®é¢˜è§£å†³æ–¹æ¡ˆã€‚  
**æœ€åŽæ›´æ–°**: 2025å¹´6æœˆ30æ—¥  
**æ–‡æ¡£ç‰ˆæœ¬**: v1.0.0


---
## ä»£ç å˜æ›´å½±å“åˆ†æžæŠ¥å‘Š (å•ä½/é”€é‡/å”®ä»·)
### ä»£ç å˜æ›´å½±å“åˆ†æžæŠ¥å‘Š

#### 1. æ¦‚è¿°

æœ¬æŠ¥å‘Šæ—¨åœ¨å…¨é¢åˆ†æžè¿‘æœŸå›´ç»•â€œå•ä½è½¬æ¢â€ã€â€œé”€é‡â€å’Œâ€œå”®ä»·â€ä¸‰å¤§æ ¸å¿ƒä¸šåŠ¡é€»è¾‘æ‰€åšçš„ä»£ç å˜æ›´ã€‚é€šè¿‡æ•´åˆåˆ†æžå¤šä¸ªå…³é”®æ–‡ä»¶ï¼ŒåŒ…æ‹¬æ•°æ®å¯¼å…¥è„šæœ¬ã€æ•°æ®åº“ç»“æž„å®šä¹‰ã€åŽç«¯ API å’ŒæŠ€æœ¯æ–‡æ¡£ï¼Œæˆ‘ä»¬è¯†åˆ«äº†æ‰€æœ‰å—å½±å“çš„ç³»ç»Ÿç»„ä»¶ã€‚æœ¬æ¬¡å˜æ›´çš„æ ¸å¿ƒç›®æ ‡æ˜¯ç»Ÿä¸€æ•°æ®åº¦é‡è¡¡ã€ç²¾ç¡®åŒ–å…³é”®ä¸šåŠ¡æŒ‡æ ‡ï¼ˆå¦‚å¹³å‡å”®ä»·ï¼‰çš„è®¡ç®—é€»è¾‘ï¼Œå¹¶ç¡®ä¿æ•´ä¸ªç³»ç»Ÿä»Žæ•°æ®æºåˆ°å‰ç«¯å±•ç¤ºçš„ä¸€è‡´æ€§å’Œå‡†ç¡®æ€§ã€‚

---

#### 2. å—å½±å“çš„æ–‡ä»¶åŠå…·ä½“å˜æ›´åˆ†æž

ä»¥ä¸‹æ˜¯æœ¬æ¬¡å˜æ›´æ¶‰åŠçš„æ ¸å¿ƒæ–‡ä»¶åˆ—è¡¨åŠå…¶è¯¦ç»†åˆ†æžï¼š

*   **[`data_importer.py`](data_importer.py)**
    *   **å˜æ›´æè¿°:** æ­¤æ–‡ä»¶æ˜¯æ ¸å¿ƒæ•°æ®å¯¼å…¥çš„èµ·ç‚¹ï¼ŒåŒ…å«äº†å…³é”®çš„åˆå§‹æ•°æ®è½¬æ¢å’Œæ¸…æ´—é€»è¾‘ã€‚
    *   **å…·ä½“å†…å®¹:**
        *   **å•ä½è½¬æ¢:** åœ¨[`clean_and_load_excel()`](data_importer.py:163)å‡½æ•°ä¸­ï¼Œæ˜Žç¡®å¯¹äº§é‡ï¼ˆ[`production_volume`](data_importer.py:182)ï¼‰å’Œé”€é‡ï¼ˆ[`sales_volume`](data_importer.py:238)ï¼‰æ‰§è¡Œäº†ä»Žâ€œå…¬æ–¤(kg)â€åˆ°â€œå¨(ton)â€çš„å•ä½è½¬æ¢ï¼ˆé™¤ä»¥1000ï¼‰ã€‚è¿™æ˜¯ç¡®ä¿åŽç»­æ‰€æœ‰é”€é‡å’Œäº§é‡æ•°æ®ä¸€è‡´æ€§çš„åŸºç¡€ã€‚
        *   **å”®ä»·è®¡ç®—:** å†…éƒ¨åŒ…å«äº†å¤šç§ä»·æ ¼è®¡ç®—é€»è¾‘ï¼Œèƒ½å¤Ÿæ ¹æ®ä¸åŒçš„åŽŸå§‹åˆ—ï¼ˆå¦‚[`æœ¬å¸å«ç¨Žå•ä»·`](data_importer.py:221)ã€[`å«ç¨Žå•ä»·`](data_importer.py:224)ï¼‰æˆ–é€šè¿‡å…¬å¼ï¼ˆ[`(df['æœ¬å¸æ— ç¨Žé‡‘é¢'] / df['sales_volume']) * 1.09`](data_importer.py:229)ï¼‰è®¡ç®—å«ç¨Žä»·æ ¼ï¼Œä¸ºåŽç»­ç”Ÿæˆæ ‡å‡†åŒ–çš„é”€å”®é¢æ•°æ®æä¾›äº†æ”¯æŒã€‚
        *   **æ•°æ®æ¸…æ´—:** å®žçŽ°äº†è¯¦ç»†çš„æ•°æ®æ¸…æ´—è§„åˆ™ï¼ˆå¦‚[`apply_sales_data_filters()`](data_importer.py:124)ï¼‰ï¼Œç”¨äºŽåœ¨æ•°æ®å…¥åº“å‰å¤„ç†å¼‚å¸¸æˆ–ä¸ä¸€è‡´çš„æ•°æ®ã€‚

*   **[`import_real_data.py`](import_real_data.py)**
    *   **å˜æ›´æè¿°:** è¯¥è„šæœ¬ä¸“æ³¨äºŽå¤„ç†å®žé™…çš„ç”Ÿäº§ã€é”€å”®å’Œåº“å­˜æ•°æ®ï¼Œå¹¶åŒ…å«ä¸€ä¸ªéžå¸¸å…·ä½“çš„å¹³å‡ä»·æ ¼è®¡ç®—å…¬å¼ã€‚
    *   **å…·ä½“å†…å®¹:**
        *   **å¹³å‡ä»·æ ¼è®¡ç®—:** åœ¨[`process_sales_data()`](import_real_data.py:81)å‡½æ•°ä¸­ï¼Œè„šæœ¬æ˜Žç¡®å®šä¹‰äº†å¹³å‡ä»·æ ¼çš„è®¡ç®—å…¬å¼ä¸ºï¼š`å¹³å‡ä»·æ ¼ = (æœ¬å¸æ— ç¨Žé‡‘é¢ / ä¸»æ•°é‡) * 1.09 * 1000` ([`line 124`](import_real_data.py:124))ã€‚è¿™ä¸ªå…¬å¼æ˜¯ä¸šåŠ¡é€»è¾‘çš„æ ¸å¿ƒä½“çŽ°ï¼Œç›´æŽ¥å½±å“æœ€ç»ˆçš„å”®ä»·æŒ‡æ ‡ã€‚

*   **[`backend/schema.sql`](backend/schema.sql)**
    *   **å˜æ›´æè¿°:** å®šä¹‰äº†æ ¸å¿ƒä¸šåŠ¡æ•°æ®çš„æ•°æ®åº“å­˜å‚¨ç»“æž„ï¼Œæ˜¯æ•°æ®æŒä¹…åŒ–çš„è“å›¾ã€‚
    *   **å…·ä½“å†…å®¹:**
        *   **`DailyMetrics` è¡¨:** æ­¤è¡¨æ˜¯å…³é”®æŒ‡æ ‡çš„æœ€ç»ˆè½è„šç‚¹ã€‚å…¶ä¸­ [`production_volume`](backend/schema.sql:16)ï¼ˆäº§é‡ï¼‰ã€[`sales_volume`](backend/schema.sql:17)ï¼ˆé”€é‡ï¼‰çš„å•ä½è¢«ç¡®å®šä¸ºâ€œå¨â€ï¼Œè€Œ [`sales_amount`](backend/schema.sql:18)ï¼ˆé”€å”®é¢ï¼‰å’Œ [`average_price`](backend/schema.sql:20)ï¼ˆå¹³å‡ä»·æ ¼ï¼‰çš„å•ä½åˆ™ä¸ºâ€œå…ƒ/å¨â€ã€‚è¿™åœ¨æ•°æ®åº“å±‚é¢å¼ºåˆ¶äº†æ•°æ®çš„æ ‡å‡†åŒ–ã€‚
        *   **`PriceAdjustments` è¡¨:** ç”¨äºŽè®°å½•åŽ†å²ä»·æ ¼å˜åŠ¨ï¼Œä¸ºè¿½è¸ªå’Œåˆ†æžä»·æ ¼ç­–ç•¥æä¾›äº†æ•°æ®æ”¯æŒã€‚

*   **[`backend/src/index.ts`](backend/src/index.ts)**
    *   **å˜æ›´æè¿°:** åŽç«¯ API çš„æ ¸å¿ƒå®žçŽ°ï¼Œè´Ÿè´£å‘å‰ç«¯æä¾›å¤„ç†åŽçš„ä¸šåŠ¡æ•°æ®ã€‚
    *   **å…·ä½“å†…å®¹:**
        *   **ä¸šåŠ¡è§„åˆ™è¿‡æ»¤:** åœ¨ `ProductFilter` ç±»ä¸­åµŒå…¥äº†å¤æ‚çš„ä¸šåŠ¡è§„åˆ™ï¼ˆ[`getCompleteFilter()`](backend/src/index.ts:81)ï¼‰ï¼Œä¾‹å¦‚åœ¨ SQL æŸ¥è¯¢ä¸­ä¼šæŽ’é™¤æ‰€æœ‰å“åä¸­å¸¦â€œé²œâ€å­—çš„äº§å“ï¼Œä½†ä¼šç‰¹ä¾‹ä¿ç•™â€œå‡¤è‚ â€ã€‚è¿™ç›´æŽ¥å½±å“äº†â€œé”€é‡â€å’Œâ€œå”®ä»·â€æŒ‡æ ‡çš„ç»Ÿè®¡èŒƒå›´ã€‚
        *   **API ç«¯ç‚¹:** æä¾›äº†å¤šä¸ª API ç«¯ç‚¹ï¼ˆå¦‚ [`/api/trends/sales-price`](backend/src/index.ts:315)ï¼‰ï¼Œç”¨äºŽèŽ·å–å…³é”®ä¸šåŠ¡è¶‹åŠ¿æ•°æ®ï¼Œå¦‚äº§é”€æ¯”ã€æ€»é”€å”®é¢å’Œå¹³å‡ä»·æ ¼ï¼Œæ˜¯ä¸šåŠ¡é€»è¾‘çš„æœ€ç»ˆå‡ºå£ã€‚

*   **[`åŽŸå…ˆï¼špythonè„šæœ¬/æŠ€æœ¯æ–‡æ¡£.md`](%E5%8E%9F%E5%85%88%EF%BC%9Apython%E8%84%9A%E6%9C%AC/%E6%8A%80%E6%9C%AF%E6%96%87%E6%A1%A3.md)**
    *   **å˜æ›´æè¿°:** é¡¹ç›®çš„æŠ€æœ¯æ–‡æ¡£ï¼Œè®°å½•äº†å…³é”®çš„è®¡ç®—å…¬å¼å’Œç‰ˆæœ¬è¿­ä»£åŽ†å²ã€‚
    *   **å…·ä½“å†…å®¹:**
        *   **å…¬å¼ç¡®è®¤:** æ–‡æ¡£ä¸­æ˜Žç¡®è®°å½•äº†é”€å”®é‡‘é¢ï¼ˆ[`sales_amount = tax_free_amount * 1.09`](%E5%8E%9F%E5%85%88%EF%BC%9Apython%E8%84%9A%E6%9C%AC/%E6%8A%80%E6%9C%AF%E6%96%87%E6%A1%A3.md:63)ï¼‰å’Œå¹³å‡å•ä»·ï¼ˆ[`average_price = (tax_free_amount / sales_volume) * 1.09 * 1000`](%E5%8E%9F%E5%85%88%EF%BC%9Apython%E8%84%9A%E6%9C%AC/%E6%8A%80%E6%9C%AF%E6%96%87%E6%A1%A3.md:64)ï¼‰çš„è®¡ç®—å…¬å¼ï¼Œä¸ºä»£ç å®žçŽ°æä¾›äº†ç†è®ºä¾æ®å’Œæ ¡éªŒæ ‡å‡†ã€‚
        *   **åŽ†å²é—®é¢˜è¿½æº¯:** æåˆ°äº†åœ¨ `v2.1.0` ç‰ˆæœ¬ä¸­ä¿®å¤äº† `sales_amount` å­—æ®µå¯èƒ½ä¸º `null` çš„é—®é¢˜ï¼Œè¡¨æ˜Žå½“å‰çš„å˜æ›´æ˜¯å»ºç«‹åœ¨å¯¹åŽ†å²æ•°æ®é—®é¢˜çš„æŒç»­æ”¹è¿›ä¹‹ä¸Šã€‚

---

#### 3. æ•´ä½“å½±å“æ€»ç»“

æœ¬æ¬¡ä»£ç å˜æ›´å¯¹æ•´ä¸ªç³»ç»Ÿäº§ç”Ÿäº†æ·±è¿œä¸”ç§¯æžçš„å½±å“ï¼š

1.  **æ•°æ®å…¨é“¾è·¯æ ‡å‡†åŒ–:** ä»Žæ•°æ®å¯¼å…¥ï¼ˆ[`data_importer.py`](data_importer.py)ï¼‰åˆ°æ•°æ®å­˜å‚¨ï¼ˆ[`backend/schema.sql`](backend/schema.sql)ï¼‰ï¼Œå†åˆ°æ•°æ®æœåŠ¡ï¼ˆ[`backend/src/index.ts`](backend/src/index.ts)ï¼‰ï¼Œæ‰€æœ‰çŽ¯èŠ‚ä¸­çš„æ ¸å¿ƒåº¦é‡å•ä½ï¼ˆå¨ã€å…ƒ/å¨ï¼‰å’Œè®¡ç®—å£å¾„éƒ½å¾—åˆ°ç»Ÿä¸€ï¼Œå½»åº•è§£å†³äº†æ½œåœ¨çš„æ•°æ®ä¸ä¸€è‡´é—®é¢˜ã€‚

2.  **ä¸šåŠ¡é€»è¾‘æ˜¾å¼åŒ–:** å…³é”®çš„ä¸šåŠ¡é€»è¾‘ï¼Œå¦‚å¹³å‡å”®ä»·çš„è®¡ç®—å…¬å¼å’Œäº§å“ç­›é€‰è§„åˆ™ï¼Œè¢«æ˜Žç¡®åœ°åœ¨ä»£ç ä¸­å®žçŽ°ï¼Œå‡å°‘äº†ä¸šåŠ¡ç†è§£ä¸Šçš„æ­§ä¹‰ï¼Œå¹¶ä½¿å¾—ç³»ç»Ÿè¡Œä¸ºæ›´åŠ å¯é¢„æµ‹ã€‚

3.  **æ•°æ®å‡†ç¡®æ€§ä¸Žå¯é æ€§æå‡:** é€šè¿‡æ ‡å‡†åŒ–çš„æ•°æ®å¤„ç†æµç¨‹å’Œå¯¹åŽ†å²é—®é¢˜çš„ä¿®å¤ï¼ˆå¦‚ `sales_amount` ä¸º `null` çš„é—®é¢˜ï¼‰ï¼Œæ ¸å¿ƒä¸šåŠ¡æŠ¥è¡¨å’Œ API è¿”å›žçš„æ•°æ®å˜å¾—æ›´åŠ å‡†ç¡®å’Œå¯é ï¼Œä¸ºä¸šåŠ¡å†³ç­–æä¾›äº†åšå®žçš„æ•°æ®åŸºç¡€ã€‚

ç»¼ä¸Šæ‰€è¿°ï¼Œæœ¬æ¬¡å˜æ›´æ˜¯ä¸€æ¬¡ç³»ç»Ÿæ€§çš„ä¼˜åŒ–ï¼ŒæˆåŠŸåœ°æå‡äº†æ ¸å¿ƒä¸šåŠ¡æ•°æ®çš„è´¨é‡å’Œä¸€è‡´æ€§ã€‚
